# Authentication API

**Версия:** v0  
**Описание:** API для аутентификации и авторизации  
**Сервер:** `http://localhost:8080`

---

## Теги
- **auth-controller** — Операции аутентификации
- **jwks-controller** — Операции с JSON Web Key Set
- **user-controller** — Операции управления пользователями

---

## Эндпоинты

### 1. Регистрация пользователя
**POST** `/api/v1/auth/register`  
**Описание:** Создаёт нового пользователя в системе.

**Тело запроса** (`application/json`):
```json
{
  "email": "example@mail.com",
  "password": "password123",
  "confirmedPassword": "password123"
}
```

**Ответы:**
- **201** — Пользователь успешно создан  
- **400** — Некорректные входные данные  
- **409** — Пользователь уже существует  

---

### 2. Вход в систему
**POST** `/api/v1/auth/login`  
**Описание:** Аутентифицирует пользователя по email и паролю.

**Тело запроса** (`application/json`):
```json
{
  "email": "example@mail.com",
  "password": "password123"
}
```

**Ответ 200** (`application/json`):
```json
{
  "accessToken": "string",
  "refreshToken": "string"
}
```

**Коды ответа:**
- **200** — Успешная аутентификация  
- **401** — Неверные учетные данные  
- **400** — Некорректные входные данные  

---

### 3. Выход из системы
**POST** `/api/v1/auth/logout`  
**Описание:** Аннулирует токен аутентификации пользователя.  
**Защита:** Bearer JWT

**Ответы:**
- **200** — Успешный выход  
- **401** — Неверный или отсутствующий токен  

---

### 4. Обновление токена
**POST** `/api/v1/auth/refresh`  
**Описание:** Получение нового access-токена с помощью refresh-токена.

**Тело запроса**:
```json
{
  "refreshToken": "string"
}
```

**Ответ 200**:
```json
{
  "accessToken": "string",
  "refreshToken": "string"
}
```

**Коды ответа:**
- **200** — Токен успешно обновлён  
- **401** — Неверный или просроченный refresh-токен  
- **400** — Некорректные данные  

---

### 5. Смена пароля пользователя
**POST** `/api/v1/auth/user/{userId}/password/change`  
**Описание:** Меняет пароль указанного пользователя.  
**Параметры:**
- `userId` (path, **uuid**) — ID пользователя  

**Защита:** Bearer JWT

**Тело запроса**:
```json
{
  "oldPassword": "oldPassword123",
  "newPassword": "newPassword456",
  "confirmedNewPassword": "newPassword456"
}
```

**Ответы:**
- **200** — Пароль успешно изменён  
- **400** — Некорректные данные  
- **401** — Нет токена или он недействителен  
- **403** — Недостаточно прав  
- **404** — Пользователь не найден  

---

### 6. Деактивация пользователя
**POST** `/api/v1/auth/user/{userId}/deactivate`  
**Описание:** Помечает учётную запись пользователя как неактивную.  
**Параметры:** `userId` (uuid) — ID пользователя  
**Защита:** Bearer JWT

**Ответы:**
- **200** — Пользователь деактивирован  
- **401** — Нет токена или он недействителен  
- **403** — Недостаточно прав  
- **404** — Пользователь не найден  

---

### 7. Реактивация пользователя
**POST** `/api/v1/auth/user/{userId}/reactivate`  
**Описание:** Повторно активирует учётную запись пользователя.  
**Параметры:** `userId` (uuid) — ID пользователя  
**Защита:** Bearer JWT

**Ответы:**
- **200** — Пользователь реактивирован  
- **401** — Нет токена или он недействителен  
- **403** — Недостаточно прав  
- **404** — Пользователь не найден  

---

### 8. Получение JWKS
**GET** `/.well-known/jwks.json`  
**Описание:** Возвращает публичные ключи для проверки JWT.

**Пример ответа**:
```json
{
  "keys": [
    {
      "kty": "RSA",
      "kid": "main-key",
      "n": "Base64_URL_Encoded_Modulus",
      "e": "Base64_URL_Encoded_Exponent",
      "alg": "RS256",
      "use": "sig"
    }
  ]
}
```

---

## Схемы данных

### SignInRequest
| Поле      | Тип     | Обязательное | Описание      |
|-----------|---------|--------------|---------------|
| email     | string | да           | Email пользователя |
| password  | string | да         | Пароль       |

---

### SignUpRequest
| Поле              | Тип    | Обязательное | Описание                  |
|-------------------|--------|--------------|---------------------------|
| email             | string | да           | Email пользователя       |
| password          | string | да         | Пароль                   |
| confirmedPassword | string | да         | Подтверждение пароля     |

---

### AuthResponse
| Поле         | Тип     | Описание                |
|--------------|---------|-------------------------|
| accessToken  | string  | JWT access-токен        |
| refreshToken | string  | JWT refresh-токен       |

---

### RefreshTokenRequest
| Поле         | Тип    | Обязательное | Описание               |
|--------------|--------|--------------|------------------------|
| refreshToken | string | да           | Действительный refresh-токен |

---

### ChangePasswordRequest
| Поле                 | Тип     | Обязательное | Описание                      |
|----------------------|---------|--------------|--------------------------------|
| oldPassword          | string | да | Текущий пароль                 |
| newPassword          | string | да | Новый пароль                   |
| confirmedNewPassword | string | да | Подтверждение нового пароля    |

---

## Авторизация
**Схема:** Bearer Token (JWT)  
**Формат:**  
```
Authorization: Bearer <token>
```
